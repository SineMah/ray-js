!function(t,n){"object"==typeof exports&&"undefined"!=typeof module?module.exports=n():"function"==typeof define&&define.amd?define(n):(t="undefined"!=typeof globalThis?globalThis:t||self).debug=n()}(this,(function(){"use strict";class t{static init(t={}){globalThis.rayConfig={protocol:t.protocol??"http",host:t.host??"127.0.0.1",port:t.port??23517,remote_path:t.remote_path??null,local_path:t.local_path??null,host_name:t.host_name??crypto.randomUUID(),hasErrorListener:!1},!1===globalThis.rayConfig.hasErrorListener&&(globalThis.rayConfig.hasErrorListener=!0,window.addEventListener("error",(async t=>{const n=`${t.type}: ${t.message}\n                    at ${t.filename}:${t.lineno}`;await(await Ray.dump(n)).red()})))}}class n{async send(t){const n=await fetch(this.url(),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)});return"ok"===await n.text()}url(){return`${globalThis.rayConfig.protocol}://${globalThis.rayConfig.host}:${globalThis.rayConfig.port}`}}class i{static run(t,n){return new i(t,n)}constructor(t,n){this.uuid=t,this.origin=n}async purple(){return await this.color("purple"),new i(this.uuid,this.origin)}async green(){return await this.color("green"),new i(this.uuid,this.origin)}async orange(){return await this.color("orange"),new i(this.uuid,this.origin)}async blue(){return await this.color("blue"),new i(this.uuid,this.origin)}async grey(){return await this.color("grey"),new i(this.uuid,this.origin)}async red(){return await this.color("red"),new i(this.uuid,this.origin)}async color(t){const i=new n,e={uuid:this.uuid,payloads:[{type:"color",content:{color:t},origin:this.origin}],meta:{}};await i.send(e)}}class e{async processCommand(t,i){const e=crypto.randomUUID(),r=this.getOrigin(),o=this.getPayload(e,t,i,r),s=new n;return await s.send(o),{uuid:e,origin:r,payload:o}}getPayload(t,n,i,e){return{uuid:t,payloads:[{type:n,content:i,origin:e}],meta:{}}}getOrigin(){const t=this.getStackTrace();return{file:t.file,line_number:t.line,hostname:globalThis.rayConfig.host_name}}getStackTrace(){let t=(new Error).stack.split("\n").slice(-1)[0]??"";t=t.replace("at","").trim();const n=t.split(":");n.pop();const i=n.pop();return{file:n.join(":"),line:i}}}class r{static getString(t){return"string"!=typeof t&&(t=JSON.stringify(t,null,4)),t}}class o extends e{async run(t){const n={value:t},e=await this.processCommand("notify",r.getString(n));return new i(e.uuid,e.origin)}}class s extends e{async run(t){const n={values:[t]},e=await this.processCommand("log",r.getString(n));return new i(e.uuid,e.origin)}}class a extends e{async run(t){const n={value:r.getString(t)},e=await this.processCommand("json_string",n);return new i(e.uuid,e.origin)}}class u extends e{async run(){const t={formatted:(new Date).toISOString(),timestamp:Math.floor(Date.now()/1e3),timezone:Intl.DateTimeFormat().resolvedOptions().timeZone},n=await this.processCommand("carbon",t);return new i(n.uuid,n.origin)}}class c extends e{async run(t,n){const e={content:t,label:n},r=await this.processCommand("custom",e);return new i(r.uuid,r.origin)}}class l extends e{async run(t){const n={content:`<pre class="relative overflow-x-auto w-full p-5 h-auto bg-gray-100 dark:bg-gray-800"><code class="h-auto">${r.getString(t)}</code></pre>`,label:""},e=await this.processCommand("custom",n);return new i(e.uuid,e.origin)}}return{ray:class{static config(n={}){t.init(n)}static async log(t){const n=new s,e=await n.run(t);return i.run(e.uuid,e.origin)}static async json(t){const n=new a,e=await n.run(t);return i.run(e.uuid,e.origin)}static async time(){const t=new u,n=await t.run();return i.run(n.uuid,n.origin)}static async notify(t){const n=new o,e=await n.run(t);return i.run(e.uuid,e.origin)}static async custom(t,n){const e=new c,r=await e.run(t,n);return i.run(r.uuid,r.origin)}static async dump(t){const n=new l,e=await n.run(t);return i.run(e.uuid,e.origin)}}}}));
